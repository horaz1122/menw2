<!DOCTYPE html>
<html lang="ckb" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Horaz IT - Pro Editor</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@700;900&family=Rudaw&display=swap');
        
        body { 
            font-family: 'Rudaw', sans-serif; 
            background-color: #1e293b; /* Slate-800 for UI background */
            overflow: hidden; /* Hide scrollbars for the app UI */
        }

        /* Glass Panel Style - More refined */
        .glass-panel {
            background: rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(14px);
            border: 1px solid rgba(255, 255, 255, 0.15);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
        }
        .glass-panel:hover {
            background: rgba(255, 255, 255, 0.12);
            transform: translateX(-5px);
        }

        .brand-text {
            font-family: 'Montserrat', sans-serif;
            text-shadow: 0 0 30px rgba(56, 189, 248, 0.4); /* Softer blue glow */
            letter-spacing: 2px;
        }

        /* Improved Device Frames */
        .monitor-frame {
            background: #0f172a;
            border: 10px solid #334155;
            border-radius: 12px;
            position: relative;
            box-shadow: 0 25px 60px rgba(0,0,0,0.6);
            overflow: hidden;
            cursor: pointer;
        }
        .laptop-frame {
            background: #0f172a;
            border: 8px solid #334155;
            border-radius: 10px;
            position: relative;
            box-shadow: 0 20px 50px rgba(0,0,0,0.6);
            overflow: hidden;
            cursor: pointer;
        }

        /* Upload Placeholder */
        .upload-overlay {
            position: absolute; inset: 0;
            display: flex; flex-direction: column;
            align-items: center; justify-content: center;
            background: rgba(15, 23, 42, 0.85); color: #cbd5e1;
            opacity: 1; transition: opacity 0.3s;
            z-index: 20;
        }
        .has-image .upload-overlay { opacity: 0; }
        .has-image:hover .upload-overlay { opacity: 1; }

        /* Background Gradient for the Output Image */
        .export-bg {
            /* A softer, professional deep blue/grey gradient */
            background: radial-gradient(circle at top right, #1e293b 0%, #0f172a 40%, #020617 100%);
        }

        /* Canvas Dimensions */
        .mode-post { width: 1200px; height: 630px; }
        .mode-story { width: 1080px; height: 1920px; }

        /* Preview Container to handle scaling */
        #previewContainer {
            width: 100%;
            height: calc(100vh - 80px); /* Full height minus header */
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            background-image: 
                linear-gradient(45deg, #1e293b 25%, transparent 25%), 
                linear-gradient(-45deg, #1e293b 25%, transparent 25%), 
                linear-gradient(45deg, transparent 75%, #1e293b 75%), 
                linear-gradient(-45deg, transparent 75%, #1e293b 75%);
            background-size: 20px 20px;
            background-position: 0 0, 0 10px, 10px -10px, -10px 0px;
            background-color: #334155; /* Checkerboard pattern for transparency feel */
        }
    </style>
</head>
<body class="h-screen flex flex-col">

    <div class="h-20 bg-slate-900 border-b border-slate-700 flex items-center justify-between px-6 shadow-xl z-50">
        <div class="text-white font-bold text-xl flex items-center gap-2">
            <i class="fa-solid fa-paintbrush text-blue-500"></i>
            Horaz IT Editor
        </div>

        <div class="flex gap-4">
            <div class="bg-slate-800 p-1 rounded-lg border border-slate-700 flex">
                <button onclick="setMode('post')" id="btnPost" class="px-4 py-2 rounded-md text-sm font-bold transition bg-blue-600 text-white">
                    <i class="fa-brands fa-facebook mr-2"></i> Post (Horizontal)
                </button>
                <button onclick="setMode('story')" id="btnStory" class="px-4 py-2 rounded-md text-sm font-bold transition text-slate-300 hover:bg-slate-700">
                    <i class="fa-brands fa-instagram mr-2"></i> Story (Vertical)
                </button>
            </div>

            <div class="bg-slate-800 p-1 rounded-lg border border-slate-700 flex items-center gap-2 px-3">
                <span class="text-slate-400 text-xs">لیست:</span>
                <button onclick="addItem()" class="w-8 h-8 rounded bg-green-600 hover:bg-green-500 text-white flex items-center justify-center transition" title="زیادکردنی خاڵ">
                    <i class="fa-solid fa-plus"></i>
                </button>
                <button onclick="removeItem()" class="w-8 h-8 rounded bg-red-600 hover:bg-red-500 text-white flex items-center justify-center transition" title="کەمکردنەوە">
                    <i class="fa-solid fa-minus"></i>
                </button>
            </div>
        </div>

        <button onclick="downloadImage()" class="px-6 py-2 bg-gradient-to-r from-blue-600 to-cyan-600 hover:from-blue-500 hover:to-cyan-500 text-white rounded-lg shadow-lg transition font-bold flex items-center gap-2">
            <i class="fa-solid fa-cloud-arrow-down"></i> دابەزاندن
        </button>
    </div>

    <input type="file" id="monitorInput" accept="image/*" class="hidden" onchange="loadImage(event, 'monitorImg', 'monitorOverlay')">
    <input type="file" id="laptopInput" accept="image/*" class="hidden" onchange="loadImage(event, 'laptopImg', 'laptopOverlay')">

    <div id="previewContainer">
        
        <div id="captureArea" class="mode-post export-bg relative flex flex-col items-center transition-all duration-300 shadow-2xl origin-center">
            
            <div class="absolute inset-0 opacity-10" style="background-image: radial-gradient(#94a3b8 1px, transparent 1px); background-size: 50px 50px;"></div>
            <div class="absolute top-0 right-0 w-[500px] h-[500px] bg-blue-600 rounded-full mix-blend-screen filter blur-[120px] opacity-10"></div>
            <div class="absolute bottom-0 left-0 w-[500px] h-[500px] bg-cyan-600 rounded-full mix-blend-screen filter blur-[120px] opacity-10"></div>

            <div id="headerSection" class="relative z-10 pt-12 pb-4 text-center w-full">
                <h1 class="brand-text text-7xl font-extrabold text-white tracking-widest">HORAZ IT</h1>
                <div class="w-24 h-1 bg-blue-500 mx-auto mt-4 rounded-full shadow-[0_0_15px_rgba(59,130,246,0.8)]"></div>
            </div>

            <div id="layoutContainer" class="relative z-10 flex w-full h-full p-10 gap-10 items-center justify-center">
                
                <div class="flex-1 flex justify-center items-center group">
                    <div class="relative w-80 transition transform group-hover:-translate-y-2 duration-500" onclick="document.getElementById('laptopInput').click()">
                        <div class="laptop-frame h-48 bg-slate-900 relative" id="laptopOverlay">
                            <img id="laptopImg" src="" class="w-full h-full object-cover hidden">
                            <div class="upload-overlay backdrop-blur-sm">
                                <i class="fa-solid fa-laptop-code text-4xl mb-3 text-blue-400"></i>
                                <span class="text-sm font-bold">Upload Laptop</span>
                            </div>
                        </div>
                        <div class="h-3 bg-gradient-to-b from-slate-600 to-slate-800 rounded-b-xl w-[110%] -mr-[5%] mt-1 shadow-lg"></div>
                    </div>
                </div>

                <div id="listSection" class="w-full max-w-[500px] flex flex-col gap-5 z-20 transition-all">
                    <div class="glass-panel rounded-xl p-5 flex items-center gap-5">
                        <div class="bg-gradient-to-br from-green-400 to-emerald-600 rounded-full w-8 h-8 flex items-center justify-center shrink-0 shadow-lg shadow-green-500/30">
                            <i class="fa-solid fa-check text-white text-sm"></i>
                        </div>
                        <div contenteditable="true" class="text-white text-2xl font-bold bg-transparent outline-none w-full leading-relaxed" dir="auto">سیستەمی ژمێریاری</div>
                    </div>

                    <div class="glass-panel rounded-xl p-5 flex items-center gap-5">
                        <div class="bg-gradient-to-br from-green-400 to-emerald-600 rounded-full w-8 h-8 flex items-center justify-center shrink-0 shadow-lg shadow-green-500/30">
                            <i class="fa-solid fa-check text-white text-sm"></i>
                        </div>
                        <div contenteditable="true" class="text-white text-2xl font-bold bg-transparent outline-none w-full leading-relaxed" dir="auto">دروستکردنی وێبسایت</div>
                    </div>

                    <div class="glass-panel rounded-xl p-5 flex items-center gap-5">
                        <div class="bg-gradient-to-br from-green-400 to-emerald-600 rounded-full w-8 h-8 flex items-center justify-center shrink-0 shadow-lg shadow-green-500/30">
                            <i class="fa-solid fa-check text-white text-sm"></i>
                        </div>
                        <div contenteditable="true" class="text-white text-2xl font-bold bg-transparent outline-none w-full leading-relaxed" dir="auto">پاراستنی داتا</div>
                    </div>
                </div>

                <div class="flex-1 flex flex-col items-center justify-center group">
                    <div class="relative w-96 transition transform group-hover:-translate-y-2 duration-500" onclick="document.getElementById('monitorInput').click()">
                        <div class="monitor-frame h-56 bg-slate-900 relative" id="monitorOverlay">
                            <img id="monitorImg" src="" class="w-full h-full object-cover hidden">
                            <div class="upload-overlay backdrop-blur-sm">
                                <i class="fa-solid fa-desktop text-4xl mb-3 text-cyan-400"></i>
                                <span class="text-sm font-bold">Upload Monitor</span>
                            </div>
                        </div>
                        <div class="w-20 h-10 bg-slate-700 mx-auto"></div> <div class="w-32 h-2 bg-slate-600 mx-auto rounded-t-lg shadow-lg"></div> </div>
                </div>

            </div>

            <div class="absolute bottom-8 w-full text-center">
                 <div class="text-slate-400 text-sm font-bold tracking-[0.3em] uppercase opacity-70">
                    Solution Provider
                </div>
            </div>

        </div>
    </div>

    <script>
        let currentMode = 'post';

        // Initialize
        function init() {
            setMode('post');
            adjustZoom();
            window.addEventListener('resize', adjustZoom);
        }

        // Add New Row
        function addItem() {
            const list = document.getElementById('listSection');
            
            // Create element string
            const newItemHTML = `
                <div class="glass-panel rounded-xl p-5 flex items-center gap-5 animate-fadeIn">
                    <div class="bg-gradient-to-br from-green-400 to-emerald-600 rounded-full w-8 h-8 flex items-center justify-center shrink-0 shadow-lg shadow-green-500/30">
                        <i class="fa-solid fa-check text-white text-sm"></i>
                    </div>
                    <div contenteditable="true" class="text-white text-2xl font-bold bg-transparent outline-none w-full leading-relaxed" dir="auto">
                        خزمەتگوزاری نوێ
                    </div>
                </div>
            `;
            
            // Append as HTML
            const div = document.createElement('div');
            div.innerHTML = newItemHTML.trim();
            list.appendChild(div.firstChild);
        }

        // Remove Last Row
        function removeItem() {
            const list = document.getElementById('listSection');
            if (list.children.length > 1) { // Keep at least 1
                list.removeChild(list.lastElementChild);
            }
        }

        function setMode(mode) {
            currentMode = mode;
            const captureArea = document.getElementById('captureArea');
            const layoutContainer = document.getElementById('layoutContainer');
            const header = document.getElementById('headerSection');
            
            // Button Styles
            const btnPost = document.getElementById('btnPost');
            const btnStory = document.getElementById('btnStory');

            if (mode === 'post') {
                // Style Logic
                captureArea.className = `mode-post export-bg relative flex flex-col items-center transition-all duration-300 shadow-2xl origin-center`;
                layoutContainer.className = `relative z-10 flex w-full h-full p-10 gap-10 items-center justify-center flex-row`;
                header.className = "relative z-10 pt-12 pb-4 text-center w-full";
                
                // Toggle Buttons
                btnPost.className = "px-4 py-2 rounded-md text-sm font-bold transition bg-blue-600 text-white";
                btnStory.className = "px-4 py-2 rounded-md text-sm font-bold transition text-slate-300 hover:bg-slate-700";

            } else {
                // Story Logic
                captureArea.className = `mode-story export-bg relative flex flex-col items-center transition-all duration-300 shadow-2xl origin-center`;
                layoutContainer.className = `relative z-10 flex w-full h-full p-10 gap-16 items-center justify-center flex-col`;
                header.className = "relative z-10 pt-32 pb-10 text-center w-full transform scale-125"; // Bigger header for story

                // Toggle Buttons
                btnPost.className = "px-4 py-2 rounded-md text-sm font-bold transition text-slate-300 hover:bg-slate-700";
                btnStory.className = "px-4 py-2 rounded-md text-sm font-bold transition bg-purple-600 text-white";
            }
            
            adjustZoom();
        }

        // Smart Zoom Function: Fits the big canvas into the screen
        function adjustZoom() {
            const container = document.getElementById('previewContainer');
            const canvas = document.getElementById('captureArea');
            
            const containerWidth = container.clientWidth - 40; // Padding
            const containerHeight = container.clientHeight - 40;
            
            const canvasWidth = currentMode === 'post' ? 1200 : 1080;
            const canvasHeight = currentMode === 'post' ? 630 : 1920;

            const scaleX = containerWidth / canvasWidth;
            const scaleY = containerHeight / canvasHeight;
            
            // Choose the smaller scale to ensure it fits entirely
            const scale = Math.min(scaleX, scaleY); // Cap at 1 (100%)

            canvas.style.transform = `scale(${scale})`;
        }

        // Image Handling
        function loadImage(event, imgId, overlayId) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    document.getElementById(imgId).src = e.target.result;
                    document.getElementById(imgId).classList.remove('hidden');
                    document.getElementById(overlayId).classList.add('has-image');
                }
                reader.readAsDataURL(file);
            }
        }

        // Download
        function downloadImage() {
            const captureElement = document.getElementById('captureArea');
            
            // Temporarily remove scale transform for clean capture
            const originalTransform = captureElement.style.transform;
            captureElement.style.transform = 'scale(1)'; 
            
            // Wait a split second for render, but since we are capturing, 
            // html2canvas reads the DOM properties. 
            // Ideally we need to render it "offscreen" or just trust html2canvas to read computed styles.
            // However, html2canvas respects transforms. We need to reset scale to 1 to get full res.
            // But if we reset scale, it might explode visually. 
            // Trick: We will keep it visually handled by the user, but html2canvas options handle scale.
            
            // Actually, best practice for zoomed elements:
            html2canvas(captureElement, {
                scale: 1, // Capture at native 1:1 pixel ratio of the element (which is 1080x1920 or 1200x630)
                useCORS: true,
                backgroundColor: null,
                logging: false,
                // We must account for the CSS transform 'scale' on the element
                // By default html2canvas screenshots exactly what it sees.
                // If it sees a scaled down element, the image is small.
                // We need to trick it.
                onclone: (clonedDoc) => {
                    const clonedCanvas = clonedDoc.getElementById('captureArea');
                    clonedCanvas.style.transform = 'scale(1)'; // Force full size in clone
                    // Center it in clone just in case
                    clonedCanvas.style.margin = '0';
                }
            }).then(canvas => {
                // Restore visual scale
                captureElement.style.transform = originalTransform;

                const link = document.createElement('a');
                link.download = `Horaz-IT-${currentMode}.png`;
                link.href = canvas.toDataURL('image/png');
                link.click();
            });
        }

        // Start
        init();
    </script>
</body>
</html>
